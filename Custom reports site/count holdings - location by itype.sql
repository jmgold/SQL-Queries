/*
Jeremy Goldstein
Minuteman Library Network

Holdings Profile gathered for annual reports
location code by itype

Passed variables for owning location and item statuses to exclude
*/
SELECT
i.location_code,
COUNT(i.id) FILTER(WHERE i.itype_code_num = 0) AS "0",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 1) AS "1",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 2) AS "2",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 3) AS "3",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 4) AS "4",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 5) AS "5",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 6) AS "6",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 7) AS "7",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 8) AS "8",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 9) AS "9",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 10) AS "10",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 11) AS "11",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 12) AS "12",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 13) AS "13",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 14) AS "14",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 15) AS "15",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 16) AS "16",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 17) AS "17",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 18) AS "18",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 19) AS "19",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 20) AS "20",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 21) AS "21",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 22) AS "22",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 23) AS "23",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 24) AS "24",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 25) AS "25",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 26) AS "26",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 27) AS "27",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 28) AS "28",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 29) AS "29",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 30) AS "30",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 31) AS "31",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 32) AS "32",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 33) AS "33",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 34) AS "34",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 35) AS "35",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 36) AS "36",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 37) AS "37",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 38) AS "38",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 39) AS "39",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 40) AS "40",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 41) AS "41",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 42) AS "42",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 43) AS "43",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 44) AS "44",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 45) AS "45",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 46) AS "46",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 47) AS "47",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 48) AS "48",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 49) AS "49",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 50) AS "50",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 51) AS "51",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 52) AS "52",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 53) AS "53",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 54) AS "54",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 55) AS "55",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 56) AS "56",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 57) AS "57",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 58) AS "58",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 59) AS "59",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 60) AS "60",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 61) AS "61",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 62) AS "62",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 63) AS "63",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 64) AS "64",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 65) AS "65",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 66) AS "66",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 67) AS "67",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 68) AS "68",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 69) AS "69",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 70) AS "70",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 71) AS "71",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 72) AS "72",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 73) AS "73",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 74) AS "74",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 75) AS "75",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 76) AS "76",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 77) AS "77",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 78) AS "78",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 79) AS "79",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 80) AS "80",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 81) AS "81",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 82) AS "82",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 83) AS "83",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 84) AS "84",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 85) AS "85",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 86) AS "86",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 87) AS "87",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 88) AS "88",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 89) AS "89",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 90) AS "90",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 91) AS "91",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 92) AS "92",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 93) AS "93",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 94) AS "94",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 95) AS "95",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 96) AS "96",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 97) AS "97",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 98) AS "98",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 99) AS "99",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 100) AS "100",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 101) AS "101",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 102) AS "102",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 103) AS "103",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 104) AS "104",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 105) AS "105",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 106) AS "106",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 107) AS "107",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 108) AS "108",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 109) AS "109",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 110) AS "110",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 111) AS "111",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 112) AS "112",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 113) AS "113",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 114) AS "114",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 115) AS "115",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 116) AS "116",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 117) AS "117",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 118) AS "118",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 119) AS "119",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 120) AS "120",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 121) AS "121",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 122) AS "122",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 123) AS "123",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 124) AS "124",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 125) AS "125",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 126) AS "126",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 127) AS "127",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 128) AS "128",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 129) AS "129",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 130) AS "130",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 131) AS "131",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 132) AS "132",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 133) AS "133",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 134) AS "134",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 135) AS "135",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 136) AS "136",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 137) AS "137",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 138) AS "138",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 139) AS "139",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 140) AS "140",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 141) AS "141",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 142) AS "142",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 143) AS "143",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 144) AS "144",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 145) AS "145",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 146) AS "146",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 147) AS "147",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 148) AS "148",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 149) AS "149",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 150) AS "150",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 151) AS "151",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 152) AS "152",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 153) AS "153",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 154) AS "154",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 155) AS "155",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 156) AS "156",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 157) AS "157",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 158) AS "158",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 159) AS "159",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 160) AS "160",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 161) AS "161",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 162) AS "162",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 163) AS "163",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 164) AS "164",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 165) AS "165",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 166) AS "166",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 167) AS "167",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 168) AS "168",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 169) AS "169",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 170) AS "170",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 171) AS "171",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 172) AS "172",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 173) AS "173",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 174) AS "174",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 175) AS "175",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 176) AS "176",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 177) AS "177",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 178) AS "178",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 179) AS "179",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 180) AS "180",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 181) AS "181",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 182) AS "182",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 183) AS "183",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 184) AS "184",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 185) AS "185",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 186) AS "186",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 187) AS "187",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 188) AS "188",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 189) AS "189",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 190) AS "190",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 191) AS "191",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 192) AS "192",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 193) AS "193",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 194) AS "194",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 195) AS "195",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 196) AS "196",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 197) AS "197",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 198) AS "198",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 199) AS "199",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 200) AS "200",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 201) AS "201",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 202) AS "202",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 203) AS "203",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 204) AS "204",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 205) AS "205",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 206) AS "206",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 207) AS "207",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 208) AS "208",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 209) AS "209",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 210) AS "210",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 211) AS "211",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 212) AS "212",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 213) AS "213",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 214) AS "214",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 215) AS "215",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 216) AS "216",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 217) AS "217",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 218) AS "218",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 219) AS "219",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 220) AS "220",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 221) AS "221",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 222) AS "222",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 223) AS "223",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 224) AS "224",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 225) AS "225",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 226) AS "226",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 227) AS "227",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 228) AS "228",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 229) AS "229",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 230) AS "230",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 231) AS "231",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 232) AS "232",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 233) AS "233",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 234) AS "234",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 235) AS "235",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 236) AS "236",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 237) AS "237",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 238) AS "238",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 239) AS "239",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 240) AS "240",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 241) AS "241",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 242) AS "242",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 243) AS "243",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 244) AS "244",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 245) AS "245",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 246) AS "246",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 247) AS "247",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 248) AS "248",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 249) AS "249",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 250) AS "250",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 251) AS "251",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 252) AS "252",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 253) AS "253",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 254) AS "254",
COUNT(i.id) FILTER(WHERE i.itype_code_num = 255) AS "255"

FROM
sierra_view.item_record as i

WHERE
i.location_code ~ {{Location}}
AND i.item_status_code NOT IN ({{Item_Status_Codes}})

GROUP BY
1
ORDER BY
1