/*
Jeremy Goldstein & Jenn Del Cegno
Minuteman Library Network
Lazy way to generate curated book list for website
www.minlib.net
*/
SELECT *
FROM(
SELECT
--link to Encore
'https://find.minlib.net/iii/encore/record/C__R'||id2reckey(b.bib_record_id)   AS field_booklist_entry_encore_url,
b.best_title as title,
REPLACE(SPLIT_PART(SPLIT_PART(b.best_author,' (',1),', ',2),'.','')||' '||SPLIT_PART(b.best_author,', ',1) as field_booklist_entry_author,
'https://syndetics.com/index.aspx?isbn='||SUBSTRING(MAX(s.content) FROM '[0-9]+')||'/SC.gif&client=minuteman' AS field_booklist_entry_cover
FROM
sierra_view.bib_record_property b
JOIN sierra_view.subfield s
ON
b.bib_record_id = s.record_id AND s.marc_tag = '020' AND s.tag = 'a'
JOIN sierra_view.bib_record_item_record_link bi
ON
b.bib_record_id = bi.bib_record_id
JOIN
sierra_view.bib_view v
ON
b.bib_record_id = v.id AND
v.record_num IN (
'3978824',
'3963948',
'1792167',
'1788103',
'3653087',
'3600818',
'3683296',
'3585282',
'3568908',
'2919541',
'3245384',
'3966856',
'4014443',
'3961073',
'3655238',
'3715323',
'1125904',
'3445169',
'2507573',
'2151132',
'3914638',
'2843007',
'2591791',
'3923114',
'3922860',
'3879763',
'3915898',
'2369914',
'3742017',
'3449279',
'3961328',
'3978819',
'3599515',
'3775363',
'3599540',
'2174745',
'3917187',
'3919024',
'3892398',
'3269951',
'3918962',
'3918949',
'3919038',
'3918926',
'3998986',
'1988822',
'2614212',
'3949016',
'3949047',
'1798367',
'3051023',
'3529563',
'3275216',
'3269305',
'3233617',
'4024220',
'3849712',
'2989654',
'3257204',
'2889640',
'3007087',
'2969991',
'2946524',
'2982311',
'3191667',
'3992456',
'2364200',
'2238386',
'4007283',
'3756896',
'3725067',
'3792834',
'3636329',
'3675557',
'3727816',
'3866100',
'3920415',
'3939345',
'3711840',
'2551783',
'3524684',
'3633797',
'2994595',
'3714179',
'3986699',
'3959733',
'4043907',
'3999554',
'4007131',
'3857024',
'3829715',
'3727721',
'4036334',
'4026572',
'4009131',
'3862787',
'3987309',
'3969140',
'2157640',
'3236381',
'3640637',
'3673173',
'3652368',
'3950267',
'3981455',
'3767730',
'3848106',
'3801929',
'3757602',
'3855831',
'3637136',
'1997701',
'3761646',
'3465878',
'3936165',
'3962359',
'3508096',
'3909627',
'3921620',
'3436562',
'3271484',
'2734969',
'3895873',
'3757999',
'1530162',
'2345322',
'3938557',
'3938539',
'3463889',
'3603541',
'2979461',
'3962391',
'3886577',
'3226365',
'3521625',
'2144147',
'3094810',
'2217464',
'4044570',
'3455157',
'3803510',
'3499465',
'3873138',
'3596037',
'3679623',
'3678876',
'3649175',
'3934063',
'3904691',
'3873086',
'2880467',
'3644703',
'3857719',
'3717106',
'3636974',
'3636959',
'3493651',
'4011765',
'3939681',
'3863969',
'3482857',
'3963620',
'4015678',
'3499066',
'3711116',
'3736165',
'3755713',
'3980635',
'3810189',
'3779288',
'3840253',
'4000071',
'3826606',
'2355285',
'3101254',
'3945252',
'3212429',
'3649989',
'3763133',
'3746268',
'3725685',
'2705216',
'4012372',
'3157215',
'3848384',
'3855546',
'3643902',
'2877208',
'4008333',
'3940025',
'3919092',
'3828926',
'3817868',
'3473728',
'3781452',
'3490477',
'3979891',
'2516048',
'3856646',
'4001040',
'3826600',
'3634445',
'3783377',
'3828169',
'3175471',
'3807422',
'3713983',
'2611690',
'3918039',
'3777666',
'3056728',
'3193868',
'1995491',
'2740158',
'2869070',
'2889281',
'2753261',
'4012399',
'3915959',
'4041875',
'3969154',
'4045900',
'2483534',
'4048910',
'3936164',
'3939334',
'3971216',
'3837378',
'3271857',
'4012598',
'2195495',
'2333859',
'3034104',
'2318709',
'3205554',
'3229388',
'3908189',
'3860222',
'3497774',
'3994628',
'3660849',
'3727055',
'1951725',
'3215815',
'4016764',
'1589456',
'3273142',
'3719767',
'3191445',
'3599530',
'3736006',
'2492702',
'3979886',
'3832993',
'3949014',
'3949035',
'3961372',
'3961391',
'3473972',
'4041651',
'2602598',
'3722932',
'3602661',
'3800613',
'3207977',
'3901504',
'2673032',
'3719229',
'1404392',
'2605535',
'3026031',
'3964679',
'4028632',
'3217876',
'3272789',
'1613922',
'2385554',
'3194961',
'3201049',
'3229370',
'2161240',
'2052627',
'3280887',
'3434414',
'3073202',
'3828153',
'3855951',
'3649552',
'123734',
'3206195',
'2512080',
'2914209',
'3972781',
'1446617',
'3838274',
'3048537',
'2984606',
'3046354',
'3065397',
'2900726',
'3078887',
'3081845',
'2838066',
'3844455',
'3528460',
'3818846',
'3755672',
'1828727',
'2662411',
'2550013',
'3914361',
'1906257',
'2603154',
'3612021',
'4047069',
'3989911',
'2483532',
'4012088',
'3145350',
'3681147',
'3732426',
'3733083',
'3462122',
'3716833',
'3984856',
'3989848',
'3538322',
'3832841',
'4011836',
'3448822',
'3834250',
'3675471',
'3628157',
'3593711',
'3490091',
'3916537',
'3528210',
'3800632',
'3945148',
'3945105',
'3997640',
'4017009',
'3993270',
'4046254',
'3909877',
'1965764',
'3277394',
'3640356',
'3615076',
'3539958',
'3792159',
'3651996',
'3602158',
'3619055',
'2294242',
'3275947',
'3279247',
'3916273',
'3912318',
'3912207',
'3533911',
'3610633',
'3435490',
'3907918',
'3874859',
'2437743',
'3775233',
'3789183',
'3672407',
'3918620',
'3918743',
'3280856',
'2267766',
'2423787',
'3946835',
'3958873',
'3962179',
'3603486',
'3566233',
'3921284',
'3921547',
'3921528',
'3094782',
'3974353',
'1621319',
'1874159',
'1919941',
'2164985',
'3207574',
'4051439',
'3750497',
'3672759',
'3997019',
'3659783',
'3824020',
'3844133',
'3710969',
'3610872',
'3817813',
'3224607',
'3449583',
'3874597',
'3870001',
'3180873',
'3205996',
'3032871',
'3163174',
'3279600',
'2996189',
'2102831',
'2502800',
'2212069',
'2283130',
'2920028',
'2472574',
'2175231',
'3919093',
'3874874',
'4007638',
'3912302',
'4031257',
'3810654',
'1448225',
'1669384',
'1153122',
'2498145',
'3970802',
'2898451',
'2606704',
'1965765',
'3917236',
'2768517',
'2734611',
'3010597',
'3006981',
'3814277',
'2205497',
'1870684',
'3625585',
'3977855',
'3935547',
'3916546',
'3594156',
'2141377',
'1941866',
'3937564',
'3905552',
'3938570',
'4024197',
'3600492',
'2567781',
'3168465',
'3968921',
'3728561',
'1138562',
'2774220',
'1138563',
'4014445',
'3174019',
'3739834',
'2757138',
'3996092',
'3838779',
'3607462',
'2716703',
'2628363',
'3998991',
'3916672',
'3680281',
'3215978',
'3228879',
'3745662',
'2919840',
'2708763',
'2554197',
'3717544',
'3642249',
'3200556',
'4001281',
'3961843',
'3860653',
'3839386',
'3833008',
'3832223',
'3111419',
'3230221',
'3757304',
'3674153',
'3956644',
'3071854',
'2967477',
'3222952',
'3454781',
'3176158',
'2600748',
'2280315',
'119366',
'2221353',
'3659701',
'3948114',
'3855637',
'3713452',
'3538276',
'3825180',
'3818850',
'3800617',
'3833937',
'3867551',
'3880994',
'3894524',
'3188642',
'3215179',
'3881461',
'3185824',
'3841774',
'2297080',
'3985906',
'4003372',
'3963537',
'3674563',
'3673749',
'3157207',
'3433208',
'3433192',
'3899926',
'3655550',
'3801750',
'3680974',
'3605325',
'3899956',
'4011834',
'2254293',
'2852214',
'1511910',
'3938508',
'4024863',
'3059411',
'3019477',
'3653355',
'3746264',
'3614843',
'3738820',
'2861970',
'2881034',
'2715990',
'4034420',
'4026164',
'3594397',
'3445167',
'107295',
'3277475',
'3583086',
'3944553',
'3791414',
'3803476',
'3880328',
'2308149',
'1241720',
'3730858',
'3722927',
'3860659',
'3614029',
'2499129',
'2982457',
'3652040',
'3499062',
'3471863',
'3908208',
'3997634',
'3901607',
'3278526',
'3887149',
'3461647',
'4032473',
'3182769',
'3152414',
'4011864',
'3184319',
'3827714',
'1057021',
'1057020',
'2969993',
'2985811',
'3982137',
'3108394',
'2516820',
'3219110',
'3000660',
'2393914',
'2953807',
'3466010',
'3771813',
'3154819',
'3213990',
'4021289',
'3943045',
'2922131',
'4051438',
'4051440',
'4028631',
'3994802',
'3962156',
'2533907',
'3763731',
'3808388',
'3735817',
'3849711',
'3240834',
'3662312',
'3644858',
'3243249',
'3681010',
'3683530',
'3649161',
'3809717',
'3935663',
'3799331',
'2976012',
'2516944',
'2352395',
'2555747',
'3864000',
'3909129',
'3912763',
'3912846',
'3829019',
'3844121',
'2552557',
'3266970',
'3169480',
'3656377',
'3887591',
'3063110',
'2655647',
'2597878',
'2468663',
'2547713',
'4031273',
'3902406',
'3993356',
'3854868',
'3284722',
'2327018',
'3760015',
'3478805',
'3271155',
'3610810',
'3105448',
'3833745',
'2220001',
'3789469',
'3449280',
'3084301',
'3987401',
'3849749',
'3920300',
'3829482',
'3835656',
'3812178',
'3249414',
'3155414',
'2087302',
'3965472',
'3977587',
'3970368',
'3976745',
'4031870',
'4006000',
'3894969',
'2730372',
'3868315',
'3868337',
'2030276',
'3609397',
'3728555',
'3998989',
'3145503',
'3225535',
'3267291',
'3568899',
'2881632',
'3487582',
'139483',
'3740956',
'3865048',
'3860215',
'2490010',
'2352375',
'3280740',
'3629134',
'1898244',
'2882207',
'3840210',
'3842115',
'3421518',
'3188639',
'3176896',
'4019326',
'3946303',
'2757604',
'3175085',
'3492827',
'3216412',
'3739593',
'3864613',
'1099820',
'2966013',
'3101338',
'3077344',
'3183164',
'3001999',
'3278071',
'2930765',
'3895130',
'3920245',
'3896061',
'4009140',
'3616842',
'3883807',
'3772857',
'2647825',
'3908580',
'3999756',
'3946418',
'3478689',
'3680864',
'3710907',
'4005293',
'2110613',
'2236806',
'2712123',
'3959674',
'3856706',
'2864440',
'2772874',
'3631357',
'3834065',
'3606909',
'2354251',
'2448645',
'2165868',
'1858018',
'3044510',
'2859124',
'3873128',
'3445709',
'3808718',
'3753957',
'3786941',
'3622139',
'3642253',
'2756165',
'1808761',
'2880958',
'1459306',
'3039236',
'1973543',
'1962439',
'3214805',
'2953379',
'3992093',
'1955979',
'1536605',
'3892161',
'3727262',
'3021410',
'3036865',
'3058194',
'3537407',
'4022131',
'3844524',
'3742049',
'3822959',
'3809938',
'3811411',
'3839689',
'3876432',
'3902597',
'3730449',
'4036423',
'3630332',
'3157965',
'3132230',
'2905419',
'3997018',
'2607548',
'3800621',
'3836256',
'3178355',
'3136154',
'3270765',
'3526043',
'4034048',
'3195961',
'3224827',
'3777067',
'1457588',
'1796605',
'2754841',
'1539417',
'2858974',
'3757510',
'3919729',
'3919116',
'3892168',
'3910756',
'3833186',
'3761643',
'3946852',
'3829717',
'3945260',
'3900194',
'2298473',
'3858158',
'3957877',
'3739854',
'3855451',
'3964716',
'3961401',
'3941086',
'3943827',
'3184972',
'3907916',
'3903459',
'2618160',
'3882704',
'3503185',
'3503226',
'1514748',
'1955429',
'3998974',
'3760255',
'3807420',
'3071856',
'4056071',
'3568016',
'2717879',
'3508568',
'2858979',
'2137249',
'1792684',
'2200289',
'3499380',
'3855796',
'3905284',
'3897690',
'3975192',
'3131199',
'3097710',
'3746302',
'3114138',
'3628990',
'3865083',
'2487909',
'3824100',
'2077103',
'2161242',
'3882789',
'3902388',
'4005706',
'3948004',
'3922902',
'3492933',
'2421642',
'2506652',
'3675754',
'3997468',
'3002815',
'3738941',
'3629883',
'3817809',
'3614829',
'3816012',
'3855969',
'3916253',
'3212878',
'3231407',
'2513599',
'2458366',
'3730857',
'2624665',
'2884159',
'4007436',
'4005701',
'3612168',
'3963994',
'3886114',
'2708923',
'2595161',
'3910010',
'4043894',
'3943837',
'3527432',
'3725710',
'2069115',
'2718780',
'2001062',
'1908002',
'1983618',
'3789868',
'3842876',
'3196784',
'3615112',
'3818009',
'3723816',
'3655229',
'3491826',
'3428088',
'3002476',
'1946461',
'3912284',
'3154816',
'3977588',
'3967310',
'3957275',
'3196744',
'3000659',
'2727656',
'3208101',
'3191668',
'3241503',
'3863733',
'3154829',
'3164941',
'3864814',
'3861244',
'3163794',
'1565900',
'3960228',
'3960292',
'3752942',
'3753470',
'1299009',
'2863582',
'3492002',
'3055728',
'2701433',
'2908383',
'2887371',
'3428747',
'3424960',
'3789375',
'3659253',
'3147182',
'3490993',
'3830723',
'3842114',
'4031853',
'1497140',
'3993287',
'3945942',
'2280477',
'3671498',
'3830615',
'3275467',
'4011827',
'3977827',
'2662749',
'3660968',
'3818849',
'3784110',
'3999689',
'3734044',
'3867871',
'3977862',
'2280440',
'2964909',
'3461312',
'3680857',
'3789853',
'3809657',
'3882239',
'1209239',
'3659001',
'3472888',
'3455326',
'3431372',
'3993700',
'4007640',
'142184',
'4044252',
'2336909',
'3945938',
'3837361',
'3278520',
'3534656',
'3963995',
'3473851',
'3998714',
'3890373',
'3151472',
'3123152',
'3904679',
'3149081',
'1512047',
'1677033',
'3998985',
'3993687',
'3660930',
'2951524',
'3200577',
'3234680',
'3856098',
'3526512',
'3906858',
'2200381',
'3965731',
'3818848',
'3826885',
'3825178',
'3235159',
'3207178',
'2345703',
'3493783',
'1544313',
'1502114',
'3946426',
'3838471',
'3207180',
'3076151',
'3534880',
'3810643',
'3986897',
'3786590',
'3606280',
'3493784',
'3907291',
'4044323',
'3913848',
'3912243',
'3855448',
'3965457',
'3725994',
'2127249',
'3833275',
'3946313',
'3989572',
'1582398',
'2150234',
'3094515',
'1464252',
'3226315',
'3561550',
'2970234',
'3074356',
'1517125',
'3561618',
'3721847',
'3508098',
'3508090',
'3892418',
'3424366',
'3424525',
'2586334',
'3841711',
'3616952',
'2638675',
'3620411',
'4018753',
'3225712',
'3151844',
'3855603',
'3855578',
'2738540',
'3998967',
'3714145',
'2999354',
'3064321',
'3191660',
'4029985',
'3183583',
'3233554',
'3499420',
'3748447',
'3158807',
'3735793',
'1896755',
'3938431',
'3989550',
'2904774',
'3649992',
'3012029',
'3850987',
'3936492',
'3410813',
'3891244',
'3207702',
'3169873',
'3626588',
'3470613',
'3754397',
'4028108',
'3600285',
'2840934',
'3855009',
'3801376',
'3994886',
'3471858',
'3763594',
'4013457',
'3880428',
'3047809',
'2353984',
'2178878',
'1245014',
'1419849',
'126315',
'3623813',
'2736498',
'3655368',
'4000487',
'3982213',
'3948699',
'3123848',
'1960630',
'2867451',
'3051020',
'4026041',
'4035548',
'3430879',
'3281656',
'3282571',
'4057558',
'3896408',
'3853860',
'3885089',
'1943140',
'3094528',
'2743464',
'3725625',
'1505383',
'1507381',
'2417155',
'3774232',
'116456',
'3744761',
'3816554',
'3821692',
'3877765',
'3896992',
'2239767',
'3000662',
'3937560',
'3078902',
'3829722',
'2269959',
'3229677',
'3720707',
'3595244',
'3720713',
'3213372',
'2907405',
'3771680',
'3879977',
'3877807',
'3164889',
'3683308',
'1538323',
'4014436',
'3935484',
'3993773',
'3675667',
'4000474',
'4000523',
'3619113',
'1548248',
'3660167',
'3605444',
'3276426',
'3873075',
'3873148',
'3445704',
'3611863',
'3994157',
'1507130',
'3676905',
'3809984',
'3900466',
'3755069',
'3723824',
'2881626',
'3740351',
'3623922',
'4051435',
'3636977',
'3727043',
'3200567',
'3940028',
'3793202',
'3801032',
'3785612',
'3979879',
'3237962',
'3979887',
'3662254',
'3453091',
'3428464',
'3483462',
'3750615',
'3776181',
'3906711',
'3838248',
'3601619',
'3746273',
'3751339',
'3078400',
'3110520',
'4012301',
'3673522',
'3838266',
'1911837',
'2783733',
'3845733',
'3844155',
'3910476',
'1427999',
'1592490',
'2052869',
'3732470',
'3733389',
'3215023',
'3529851',
'3536998',
'2996278',
'3909623',
'1123404',
'3900029',
'3998982',
'3970369',
'3178755',
'4031860',
'2849582',
'2396881',
'3956037',
'2904766',
'2016392',
'3825521',
'2377341',
'3804327',
'3257114',
'3639439',
'3173319',
'3966282',
'3483890',
'3141835',
'2770616',
'3713138',
'3840023',
'3660427',
'3960285',
'3844096',
'3479651',
'3858978',
'2012113',
'3944735',
'2906082',
'3992302',
'4045842',
'3180878',
'3155054',
'3892876',
'3913384',
'4013922',
'3641378',
'3937979',
'3753213',
'1339388',
'2087139',
'3906143',
'3906117',
'3769250',
'3453306',
'3216491',
'3596684',
'3885663',
'3921278',
'3660165',
'3903976',
'3616697',
'3849722',
'3656228',
'3888484',
'3938581',
'3948034',
'3940169',
'3715204',
'3209636',
'3271973',
'3063769',
'2980882',
'3222926',
'3633351',
'3910818',
'3502547',
'3107784',
'3656876',
'1192476',
'3968824',
'1883525',
'3980346',
'3725281',
'3471576',
'3446240',
'2432975',
'3886894',
'3880013',
'3894593',
'3828503',
'3829011',
'3828984',
'3620436',
'2914715',
'2865619',
'3606375',
'4046863',
'3276685',
'3726087',
'3937187',
'4037083',
'3856206',
'3611978',
'2377769',
'3274018',
'3421650',
'3184318',
'3879982',
'3864829',
'1583941',
'3776636',
'3657074',
'111972',
'3731770',
'3771451',
'3237963',
'3455138',
'3728520',
'2322898',
'3279404',
'112103',
'3499432',
'3919552',
'3607493',
'3745217',
'3742040',
'3626585',
'3851868',
'3001077',
'2529485',
'3051026',
'3493969',
'2932163',
'1532931',
'2262066',
'3755985',
'3957896',
'3279386',
'3186253',
'3723916',
'3750607',
'3828999',
'1939347',
'3830066',
'2602072',
'3804625',
'3893969',
'3887567',
'2311822',
'2977381',
'3240842',
'4036880',
'2966039',
'3071604',
'2617545',
'2874010',
'3859920',
'3849945',
'1517123',
'3118528',
'1440856',
'3831717',
'3760137',
'3463844',
'3189963',
'2605821',
'1613403',
'2783718',
'3967081',
'3905157',
'3814270',
'3963542',
'3268937',
'3025954',
'3935207',
'3744016',
'3508089',
'3527249',
'3201091',
'1412595',
'3950586',
'2206932',
'3824050',
'4051437',
'3061325',
'1598301',
'3863972',
'3426702',
'1404594',
'1965672',
'3502753',
'3277974',
'2063254',
'3856939',
'3627014',
'3457739',
'3661063',
'2966075',
'3803757',
'1612883',
'1534855',
'3449133',
'2062715',
'2103120',
'3994751',
'1944160',
'2881628',
'3435492',
'3109952',
'1901306',
'3974653',
'3801043',
'3909593',
'3978139',
'1839990',
'3828112',
'3819444',
'4061484',
'3422711',
'3616658',
'3855549',
'3208362',
'2329771',
'3171343',
'113728',
'3836137',
'2486444',
'3567735',
'3809682',
'3814276',
'3474523',
'3473690',
'4030321',
'3973730',
'2447210',
'3655773',
'2621345',
'3879532',
'3940320',
'3051017',
'3851729',
'3453344',
'3838273',
'3679862',
'3481002',
'2088859',
'3920072',
'3683314',
'3436948',
'3123413',
'3602185',
'3885679',
'2641332',
'3033269',
'3200543',
'3972465',
'3922599',
'3978137',
'3895505',
'3816575',
'1438166',
'3036604',
'3760974',
'3981249',
'3892353',
'2903037',
'3899398',
'3800623',
'3842691',
'3491606',
'3202028'
)
WHERE b.material_code ='a'
GROUP BY 1,2,3 ) a
ORDER BY RANDOM()
LIMIT 100;