--Lazy way to generate staff picks booklist
SELECT
--link to Encore
'https://find.minlib.net/iii/encore/record/C__R'||id2reckey(b.bib_record_id)   AS field_booklist_entry_encore_url,
b.best_title as title,
TRIM(REPLACE(SPLIT_PART(SPLIT_PART(b.best_author,' (',1),', ',2),'.','')||' '||SPLIT_PART(b.best_author,', ',1)) as field_booklist_entry_author,
'https://syndetics.com/index.aspx?upc='||SUBSTRING(MAX(s.content) FROM '[0-9]+')||'/SC.gif&client=minuteman' AS field_booklist_entry_cover
FROM
sierra_view.bib_record_property b
JOIN sierra_view.subfield s
ON
b.bib_record_id = s.record_id AND s.marc_tag = '024' AND s.tag = 'a'
JOIN sierra_view.bib_record_item_record_link bi
ON
b.bib_record_id = bi.bib_record_id
JOIN
sierra_view.bib_view v
ON
b.bib_record_id = v.id AND
v.record_num IN ('1842257',
'1450343',
'1594411',
'1870774',
'1489182',
'1422295',
'1586239',
'1469327',
'2268492',
'1902352',
'2858000',
'3063327',
'1567799',
'1829959',
'3411480',
'1915544',
'1458522',
'1791399',
'1610605',
'1844462',
'1777737',
'2876374',
'3000302',
'1493967',
'1582297',
'1904863',
'1469737',
'1897992',
'1612407',
'2242422',
'1842544',
'1800259',
'1545242',
'1412867',
'1995909',
'2704879',
'1748227',
'1480699',
'1896670',
'1785395',
'3084912',
'1619228',
'1616568',
'2168390',
'1846432',
'1644926',
'1534405',
'1580118',
'1556941',
'2341460',
'1613323',
'1883760',
'1610705',
'1593433',
'1836674',
'1488560',
'1487633',
'1517921',
'2614519',
'1851250',
'3504493',
'3171927',
'1811449',
'1530847',
'1579416',
'1857260',
'1818553',
'2891999',
'2392221',
'1874934',
'1520825',
'1858931',
'1800264',
'1835184',
'1824095',
'1904643',
'1926684',
'1616533',
'1547310',
'1462779',
'1852111',
'1557409',
'1513323',
'2566700',
'1808389',
'1616532',
'1846859',
'1476864',
'1829956',
'1847479',
'1530841',
'1199856',
'1644910',
'1852281',
'2747916',
'3504354',
'2040595',
'1469329',
'1721606',
'1518860',
'2180734',
'3805112',
'1598214',
'1794243',
'1609344',
'1893502',
'1550668',
'1497328',
'3651359',
'3644737',
'2909653',
'2899058',
'1480897',
'1428553',
'1782303',
'1590745',
'2876443',
'3524043',
'1438890',
'3504297',
'1489173',
'1424491',
'1619361',
'1516531',
'1805458',
'2939045',
'1303074',
'2344877',
'1517914',
'1452678',
'1567805',
'1644923',
'1752896',
'1429371',
'1895918',
'1874932',
'1561343',
'1829947',
'2375402',
'1616622',
'3036351',
'1475898',
'2375844',
'2408283',
'1493968',
'1576699',
'1604638',
'1452902',
'1469931',
'1603779',
'1534174',
'1443070',
'1440160',
'3504382',
'1852112',
'2285174',
'1807258',
'1429370',
'1976848',
'1517484',
'1595262',
'1508178',
'2509981'
)
WHERE b.material_code IN ('8','j','w')
GROUP BY 1,2,3 
ORDER BY RANDOM()
LIMIT 75;
